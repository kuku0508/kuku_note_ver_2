```python
import pandas as pd

youbike_202503 = pd.read_csv(
    r"C:/Users/user/Downloads/youbike.csv",
    header=0,
    names=["借車時間","借車站點","還車時間","還車站點","借用時長","車種","借用日期"]
)


holiday_df = pd.read_csv(
    r"C:/Users/user/Downloads/station.csv",
    header=0,
    names=["日期","是否為假日"]
)
holiday_df["日期"] = pd.to_datetime(holiday_df["日期"])

# 以其中一個月份為例
youbike_202503["借用日期"] = pd.to_datetime(youbike_202503["借用日期"])

youbike_202503 = youbike_202503.merge(
    holiday_df[["日期", "是否為假日"]],
    left_on="借用日期",
    right_on="日期",
    how="left"
).drop(columns=["日期"])

# 1. 轉成 datetime
youbike_202503["借車時間"] = pd.to_datetime(youbike_202503["借車時間"])
youbike_202503["還車時間"] = pd.to_datetime(youbike_202503["還車時間"])

# 2. 取整點小時
youbike_202503["借車小時"] = youbike_202503["借車時間"].dt.floor("H")
youbike_202503["還車小時"] = youbike_202503["還車時間"].dt.floor("H")

# 3. 借車紀錄 → 借用 +1
borrow = (
    youbike_202503[["借車小時", "借車站點"]]
    .rename(columns={"借車小時": "datetime_hour", "借車站點": "站點名稱"})
    .assign(借用次數=1, 還車次數=0)
)

# 4. 還車紀錄 → 還車 +1
ret = (
    youbike_202503[["還車小時", "還車站點"]]
    .rename(columns={"還車小時": "datetime_hour", "還車站點": "站點名稱"})
    .assign(借用次數=0, 還車次數=1)
)

# 5. 合併成「流量」資料
flow = pd.concat([borrow, ret], ignore_index=True)

# 6. 只保留 2025-03-01 ~ 2025-03-31 之間的資料
mask = (flow["datetime_hour"] >= "2025-03-01") & (flow["datetime_hour"] < "2025-04-01")
flow = flow[mask].copy()

# 7. 先做有資料的小時 × 站點 aggregate（還沒補零）
agg = (
    flow.groupby(["datetime_hour", "站點名稱"], as_index=False)
        .agg({"借用次數": "sum", "還車次數": "sum"})
)

# 8. 建立完整時間軸（每小時）
full_hours = pd.date_range("2025-03-01 00:00:00",
                           "2025-03-31 23:00:00",
                           freq="H")

# 9. 取所有站點名稱
unique_stations = sorted(agg["站點名稱"].unique())

# 10. 做「所有小時 × 所有站點」的 full grid
full_grid = pd.MultiIndex.from_product(
    [full_hours, unique_stations],
    names=["datetime_hour", "站點名稱"]
).to_frame(index=False)

# 11. 把原本的 agg merge 進 full grid，沒有的補成 0
agg_full = full_grid.merge(
    agg,
    on=["datetime_hour", "站點名稱"],
    how="left"
)

agg_full[["借用次數", "還車次數"]] = (
    agg_full[["借用次數", "還車次數"]].fillna(0).astype("int64")
)

agg_full["淨借用量"] = agg_full["還車次數"] - agg_full["借用次數"]

# 12. 加上「是否為假日」用日期塞進來
holiday_df["日期"] = pd.to_datetime(holiday_df["日期"])

agg_full["日期"] = agg_full["datetime_hour"].dt.normalize()  # 取當天 00:00

agg_full = agg_full.merge(
    holiday_df[["日期", "是否為假日"]],
    on="日期",
    how="left"
)

agg_full["是否為假日"] = agg_full["是否為假日"].fillna(0).astype("int64")

# 13. 把 datetime_hour 拆成 年 / 月 / 日 / 時段（HH:MM:SS）
agg_full["年"] = agg_full["datetime_hour"].dt.year
agg_full["月"] = agg_full["datetime_hour"].dt.month
agg_full["日"] = agg_full["datetime_hour"].dt.day
agg_full["時段"] = agg_full["datetime_hour"].dt.strftime("%H:%M:%S")

# 14. 把不再需要的欄位拿掉（datetime_hour & 日期）
agg_full = agg_full.drop(columns=["datetime_hour", "日期"])

# 15. 如果你想固定欄位順序，可以這樣排：
agg_full = agg_full[["年", "月", "日", "時段",
                     "站點名稱", "是否為假日",
                     "借用次數", "還車次數", "淨借用量"]]

# 小測試：看前幾列
print(agg_full.head())

```