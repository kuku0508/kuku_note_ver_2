Cox-Stuart test，是一種無母數的統計方法，主要是在檢定樣本是否存在趨勢。
- - -
# 歷史：
Cox-Stuart test主要是由統計學家David Cox發展。除了Cox-Stuart test以外，他還提出了存活分析中的proportional hazards model。
![[David Cox.png|250]]
David Cox
- - -
## 基礎假設

- 資料由$n$筆==獨立==觀察值$X_1,X_2,X_3\ldots,X_n$組成，且==依一定順序排列==（e.g. 時間、名次）。
- 測量尺度至少為有序尺度（ordinal）。
- - -
## 檢定統計量&決策方法
在聊檢定統計量之前，我們需要先對資料做一些處理。這邊舉一個範例，方便我們理解：
隨著汙染增加，蟲族的進攻不斷，現在堡壘裡面的人們正在討論是否需要增強牆邊武器威力，一派人馬認為不需要增強，蟲族看似並沒有增加的趨勢。另外一派人馬認為，蟲族進攻越發強烈，需要增強武器威力。以下我們收集了最近50波的蟲族攻擊的蟲族數量。
$$
\begin{array}{|c|c|c|c|}
\hline
\text{波數}&\text{蟲族數量}&\text{波數}&\text{蟲族數量}\\
\hline
1&37&26&52\\
2&34&27&53\\
3&33&28&57\\
4&37&29&54\\
5&39&30&61\\
6&35&31&52\\
7&41&32&53\\
8&38&33&62\\
9&42&34&53\\
10&39&35&59\\
11&44&36&61\\
12&39&37&69\\
13&34&38&60\\
14&43&39&72\\
15&45&40&64\\
16&43&41&18\\
17&46&42&53\\
18&39&43&71\\
19&47&44&75\\
20&46&45&72\\
21&49&46&74\\
22&51&47&81\\
23&46&48&80\\
24&48&49&10\\
25&50&50&1\\
\hline
\end{array}
$$
### 檢定統計量：
- 以($X_1$ , $X_{1+C}$) , ($X_2$ , $X_{2+C}$) , $\ldots$ , ($X_{n'}$ , $X_{n'+C}$)配對每一筆數據，其中如果$n$為偶數則 $C=\frac{n'}{2}$，如果$n$為奇數則$C=\frac{n'+1}{2}$。
- 將後項減去前項，以其結果之正負號替代。

例如：
第1波以及第26波為一組，可以組成（37,57），57-37=20，以正號代替。
第16波以及第41波為一組，可以組成（43,18），18-43= -25，以負號代替。

其檢定統計量以R表示，代表某一符號之數量，符號由對立假設決定。

### 決策方式：
我們這邊會有三種類型的虛無假設，而每一個虛無假設都是用二項分配的方式去計算其P-value，根據假設的不同，p-value的成功事件也會有所不同。

虛無假設分別有：
- - -
#### 雙尾
$$
H_0\text{： There is no trend present in the data}
$$
$$
\text{versus}
$$
$$
H_1\text{： There is either an upward trend or downward trend}
$$
$$
H_0\text{： 資料中沒有顯示出任何趨勢}
$$
$$
\text{versus}
$$
$$
H_1\text{： 可能存在向上趨勢或是向下趨勢}
$$


這時候的P-Value會是 $\text{p-value}=2*P(R\leq r \mid n , 0.5)$，其中r為比較少的符號數量。
- - -
#### 單尾
$$
H_0\text{： There is no upward trend present in the data}
$$
$$
\text{versus}
$$
$$
H_1\text{： There is an upward trend}
$$
$$
H_0\text{： 資料中沒有顯示出上升趨勢}
$$
$$
\text{versus}
$$
$$
H_1\text{： 資料存在向上趨勢}
$$
這時候的P-Value會是 $\text{p-value}=P(R\leq r \mid n , 0.5)$，其中r為正號數量。

- - -
$$
H_0\text{： There is no downward trend present in the data}
$$
$$
\text{versus}
$$
$$
H_1\text{： There is an downward trend}
$$
$$
H_0\text{： 資料中沒有顯示出下降趨勢}
$$
$$
\text{versus}
$$
$$
H_1\text{： 資料存在向下趨勢}
$$
這時候的P-Value會是 $\text{p-value}=P(R\leq r \mid n , 0.5)$，其中r為負號數量。

## 應用
我們就用Cox-Stuart test 來看每一波的蟲族數量有沒有顯著的上升趨勢
我們的虛無假設就會是
$$
H_0\text{：}資料沒有呈現上升的趨勢\quad\text{versus}\quad H_1\text{：}資料呈現顯著的上升趨勢
$$
$$
\begin{array}{|c|c|c|c|}
\hline
\text{波數}&\text{蟲族數量}&\text{波數}&\text{蟲族數量}\\
\hline
1&37&26&52\\
2&34&27&53\\
3&33&28&57\\
4&37&29&54\\
5&39&30&61\\
6&35&31&52\\
7&41&32&53\\
8&38&33&62\\
9&42&34&53\\
10&39&35&59\\
11&44&36&61\\
12&39&37&69\\
13&34&38&60\\
14&43&39&72\\
15&45&40&64\\
16&43&41&18\\
17&46&42&53\\
18&39&43&71\\
19&47&44&75\\
20&46&45&72\\
21&49&46&74\\
22&51&47&81\\
23&46&48&80\\
24&48&49&10\\
25&50&50&1\\
\hline
\end{array}
$$
而我們將資料分成25組，每一組的構成為（$X_n$ , $X_{25+n}$）
最後得到如下表的成果：
$$
\begin{array}{|c|c|c|c|}
\hline
\text{波數}&\text{蟲族數量}&\text{波數}&\text{蟲族數量}&\text{符號}\\
\hline
1&37&26&52&+\\
2&34&27&53&+\\
3&33&28&57&+\\
4&37&29&54&+\\
5&39&30&61&+\\
6&35&31&52&+\\
7&41&32&53&+\\
8&38&33&62&+\\
9&42&34&53&+\\
10&39&35&59&+\\
11&44&36&61&+\\
12&39&37&69&+\\
13&34&38&60&+\\
14&43&39&72&+\\
15&45&40&64&+\\
16&43&41&18&-\\
17&46&42&53&+\\
18&39&43&71&+\\
19&47&44&75&+\\
20&46&45&72&+\\
21&49&46&74&+\\
22&51&47&81&+\\
23&46&48&80&+\\
24&48&49&10&-\\
25&50&50&1&-\\
\hline
\end{array}
$$
證號的數量ㄨㄟ