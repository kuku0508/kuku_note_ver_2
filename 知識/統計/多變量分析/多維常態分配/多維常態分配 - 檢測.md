這篇筆記將會教你，當我們今天需要檢測一組[[多變量資料|隨機矩陣]]，是否來自[[多維常態分配]]，我們會透過什麼樣的方法去進行檢測。

由於只有很少數的資料集會在低維度時接近常態，卻在高維度下不符合常態。也就是大多數資料只要在低維度是服從常態的，那在高維度的時候也會是服從常態的。

知道了這件事情之後，我們就可以知道，我們今天可以透過檢測低維度的方式，來進一步的推論該資料集的變數服從多維常態分配。反之，只要我們觀測到低維度時不服從常態，那我們就可以直接說這個資料及不服從多維常態分配。
- - -
# 方法：
如前言所述，我們可以透過檢測低維度是否服從常態，來進一步推廣到高維度常態分配。
這邊我們會檢測一維以及二維常態來推廣至高維常態。
順序上來說會先檢測一維再來檢測二維，畢竟連比較低維度的都不服從常態分配了，更遑論高維度的服從。
## 一維（univariate）
在檢測一維常態時，我們通常會使用[[Q-Q plot]]作為我們的檢測工具

### Q-Q plot
令$X_{(1)},X_{(2)},\ldots,X_{(n)}$為按照樣本分位數排序的樣本觀測值。
而$q_{(j)}$表示標準常態分配的理論分位數，其中$j=1,2\ldots,n$。

而繪製Q-Q plot的方式就是將資料的樣本分位數$x_{(j)}$與對應的理論分位數$q_{(j)}$配對。
假設今天資料來自常態分配$N(\mu,\sigma)$時，理論上$x_{(j)}$會接近$q_{(j)}$，因此我們可以看到點跟點之間呈現==線性關係==。

看到了兩個變數之間的線性關係，那我們也可以聯想到我們可以透過[[皮爾森相關係數]]的方式，來衡量。

### Shapiro-Wilk test
當然，講到檢驗是否來自常態分配，我們也可以透過[[Shapiro-Wilk test]]來直接檢定變數是否服從常態。

當我們一維檢測完之後，並且確定每一個變數都服從多維常態分配，那我們就可以檢定二維是否服從常態分配了。
## 二維
### 卡方圖
基於$(\bf{X}-\mu)'\Sigma^{-1}(\bf{X}-\mu)\sim\chi^2_p$，我們可以知道在服從雙變量常態且$p=2$的時候，我們可以知道：$$(\bf{X}-\mu)'\Sigma^{-1}(\bf{X}-\mu)\sim\chi^2_2$$
我們令$d^2_{(j)}$表示排序後的平方距離，$q_{2,(j)}$代表的是自由度為2的卡方分配對應分位數，其中：
$$
d^2_j=(\bf{x}_j-\bar{x})'\bf{S}^{-1}(\bf{x}_j -\bar{x})
$$
而繪製卡方圖就是將$(q_{2,(j)},d^2_{(j)})$的分位數配對繪製而成。
假設今天兩變數來自常態分配$N_2(\bf{\mu},\Sigma)$，理論上$q_{2,(j)}$跟$d^{2}$

- - -
parent::[[多維常態分配]],[[Q-Q plot]],[[多變量資料]],[[皮爾森相關係數]],[[Shapiro-Wilk test]]
sibling::
child::