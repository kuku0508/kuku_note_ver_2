---
參考資料:
  - Survey Sampling, International Edition; Richard L. Scheaffer, William Mendenhall. III
tags:
---
當我們今天希望可以透過[[分層抽樣]]的方式來估計[[分層抽樣 - 總和|母體總和]]，並且希望[[抽樣誤差]]不要超過一個值的時候，我們最少需要的[[樣本數]]該如何決定呢？以下告訴你：
- - -
# 推導過程
$$
\begin{align}
&a_i=\frac{n_i}{n}\Rightarrow n_i=n\,a_i\\\\

&2\sqrt{Var(N\bar{y}_{st})}=N^2Var(\bar{y}_{st})=B\Rightarrow Var(N\bar{y}_{st})=\frac{B^2}{4N^2}\\\\

&Var(N\bar{y}_{st})=\frac{1}{N^2}\sum^L_{i=1}N^2_i\left(\frac{N_i-n_i}{N_i}\right)\left(\frac{\sigma^2_i}{n_i}\right)=\frac{B^2}{4}=D\\\\

&\Rightarrow N^2D=\sum^L_{i=1}N^2_i\left(1-\frac{na_i}{N_i}\right)\left(\frac{\sigma^2_i}{na_i}\right)
=\frac{1}{n}\sum^L_{i=1}N^2_i\frac{\sigma^2_i}{a_i}-\sum^L_{i=1}N_i\sigma^2_i\\\\

&\Rightarrow n=\frac{\sum^L_{i=1}N^2_i\sigma^2_i/a_i}{N^2D+\sum^L_{i=1}N_i\sigma^2_i}

\end{align}
$$
$a_i$：第i層的[[配置率|配置率]]
$N$：母體中的抽樣單位數
$N_i$：第i層內的抽樣單位數
$n_i$：第i層的樣本數
$L$：層數
- - -
# 公式
$$
n=\frac{\sum^L_{i=1}N^2_i\sigma^2_i/a_i}{N^2D+\sum^L_{i=1}N_i\sigma^2_i}\quad where\,D=\frac{B^2}{4N^2}
$$
當我們今天需要去考慮成本的時候，則會改用以下的公式
$$
n=\frac{\left(\sum^L_{k=1}N_k\sigma_k/\sqrt{c_k}\right)\left(\sum^L_{k=1}N_k\sigma_k\sqrt{c_k}\right)}{N^2D+\sum^L_{i=1}N_i\,\sigma_i^2}\,\,where\,D=\frac{B^2}{4}
$$
$c_i$：第i層的抽樣成本
- - -
# 備註
- 當抽樣誤差B越小，代表需要的樣本數n越大。
- 當變異數越大$\sigma^2$，代表需要的樣本數也會增加。
- <font color=ffb3b6>由於樣本變異數$s^2$常常能從先前的實驗中取得，所以在估算樣本數時，我們可以用$s^2$來近似取代$\sigma^2$。</font>
- $\sigma\approx\frac{R}{4}$，其中R=[[全距]]
- - -
parent::[[分層抽樣]],[[分層抽樣 - 平均數]],[[配置率]],[[抽樣誤差]],[[全距]],[[樣本數]]
sibling::
child::